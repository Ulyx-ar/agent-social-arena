'use strict';

var http = require('../http.cjs');

const qs = (obj) => {
    const s = Object.entries(obj)
        .filter(([, v]) => v !== undefined && v !== null)
        .map(([k, v]) => `${encodeURIComponent(k)}=${encodeURIComponent(String(v))}`)
        .join("&");
    return s ? `?${s}` : "";
};
const handle = async (res) => {
    const text = await res.text();
    const json = text ? JSON.parse(text) : undefined;
    if (!res.ok) {
        const message = json?.error?.message ??
            json?.message ??
            res.statusText ??
            "Unknown Helius error";
        throw new Error(`Helius HTTP ${res.status}: ${message}`);
    }
    return json;
};
const makeEnhancedTxClientEager = (apiKey, network = "mainnet") => {
    const base = network === "devnet"
        ? "https://api-devnet.helius.xyz/v0"
        : "https://api.helius.xyz/v0";
    const getTransactions = async ({ transactions, commitment, }) => {
        const url = `${base}/transactions` + qs({ "api-key": apiKey, commitment });
        const res = await fetch(url, {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "User-Agent": http.SDK_USER_AGENT,
            },
            body: JSON.stringify({ transactions }),
        });
        return handle(res);
    };
    const getTransactionsByAddress = async ({ address, beforeSignature, afterSignature, commitment, source, type, limit, gtSlot, gteSlot, ltSlot, lteSlot, gtTime, gteTime, ltTime, lteTime, sortOrder, }) => {
        const url = `${base}/addresses/${address}/transactions` +
            qs({
                "api-key": apiKey,
                "before-signature": beforeSignature,
                "after-signature": afterSignature,
                commitment,
                source,
                type,
                limit,
                "gt-slot": gtSlot,
                "gte-slot": gteSlot,
                "lt-slot": ltSlot,
                "lte-slot": lteSlot,
                "gt-time": gtTime,
                "gte-time": gteTime,
                "lt-time": ltTime,
                "lte-time": lteTime,
                "sort-order": sortOrder,
            });
        const res = await fetch(url, {
            method: "GET",
            headers: { "User-Agent": http.SDK_USER_AGENT },
        });
        return handle(res);
    };
    return {
        getTransactions,
        getTransactionsByAddress,
    };
};

exports.makeEnhancedTxClientEager = makeEnhancedTxClientEager;
//# sourceMappingURL=client.eager.cjs.map
