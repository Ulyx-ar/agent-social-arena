'use strict';

const isPending = (x) => {
    return !!x && typeof x.send === "function";
};
const wrapAutoSend = (raw) => {
    const added = new Map();
    return new Proxy(raw, {
        get(target, prop, receiver) {
            if (added.has(prop))
                return added.get(prop);
            const value = Reflect.get(target, prop, receiver);
            if (typeof value !== "function")
                return value;
            const wrapper = function (...args) {
                const result = value.apply(this, args);
                return isPending(result) ? result.send() : result;
            };
            return wrapper;
        },
        set(_target, prop, value) {
            added.set(prop, value);
            return true;
        },
        has(target, prop) {
            return added.has(prop) || Reflect.has(target, prop);
        },
    });
};

exports.wrapAutoSend = wrapAutoSend;
//# sourceMappingURL=wrapAutoSend.cjs.map
