{"version":3,"file":"createUnstakeTransaction.cjs","sources":["../../../../src/staking/createUnstakeTransaction.ts"],"sourcesContent":["import {\n  Address,\n  appendTransactionMessageInstructions,\n  createTransactionMessage,\n  getBase64EncodedWireTransaction,\n  KeyPairSigner,\n  pipe,\n  Rpc,\n  setTransactionMessageFeePayer,\n  setTransactionMessageLifetimeUsingBlockhash,\n  signTransactionMessageWithSigners,\n  SolanaRpcApi,\n} from \"@solana/kit\";\n\nimport { getDeactivateInstruction } from \"@solana-program/stake\";\n\nimport { SYSVAR_CLOCK } from \"./types\";\n\nexport const makeCreateUnstakeTransaction = ({\n  rpc,\n}: {\n  rpc: Rpc<SolanaRpcApi>;\n}) => {\n  return async (\n    ownerSigner: KeyPairSigner<string>,\n    stakeAccount: Address\n  ): Promise<{ serializedTx: string }> => {\n    const deactivateIx = getDeactivateInstruction({\n      stake: stakeAccount,\n      clockSysvar: SYSVAR_CLOCK,\n      stakeAuthority: ownerSigner,\n    });\n\n    const { value: blockHeight } = await rpc.getLatestBlockhash().send();\n\n    const msg = pipe(\n      createTransactionMessage({ version: 0 }),\n      (m) => setTransactionMessageFeePayer(ownerSigner.address, m),\n      (m) => setTransactionMessageLifetimeUsingBlockhash(blockHeight, m),\n      (m) => appendTransactionMessageInstructions([deactivateIx], m)\n    );\n\n    const signedTx = await signTransactionMessageWithSigners(msg);\n    const serializedTx = getBase64EncodedWireTransaction(signedTx);\n\n    return { serializedTx };\n  };\n};\n"],"names":["getDeactivateInstruction","SYSVAR_CLOCK","pipe","createTransactionMessage","setTransactionMessageFeePayer","setTransactionMessageLifetimeUsingBlockhash","appendTransactionMessageInstructions","signTransactionMessageWithSigners","getBase64EncodedWireTransaction"],"mappings":";;;;;;MAkBa,4BAA4B,GAAG,CAAC,EAC3C,GAAG,GAGJ,KAAI;AACH,IAAA,OAAO,OACL,WAAkC,EAClC,YAAqB,KACgB;QACrC,MAAM,YAAY,GAAGA,8BAAwB,CAAC;AAC5C,YAAA,KAAK,EAAE,YAAY;AACnB,YAAA,WAAW,EAAEC,kBAAY;AACzB,YAAA,cAAc,EAAE,WAAW;AAC5B,SAAA,CAAC;AAEF,QAAA,MAAM,EAAE,KAAK,EAAE,WAAW,EAAE,GAAG,MAAM,GAAG,CAAC,kBAAkB,EAAE,CAAC,IAAI,EAAE;QAEpE,MAAM,GAAG,GAAGC,QAAI,CACdC,4BAAwB,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,EACxC,CAAC,CAAC,KAAKC,iCAA6B,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC,CAAC,EAC5D,CAAC,CAAC,KAAKC,+CAA2C,CAAC,WAAW,EAAE,CAAC,CAAC,EAClE,CAAC,CAAC,KAAKC,wCAAoC,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC,CAC/D;AAED,QAAA,MAAM,QAAQ,GAAG,MAAMC,qCAAiC,CAAC,GAAG,CAAC;AAC7D,QAAA,MAAM,YAAY,GAAGC,mCAA+B,CAAC,QAAQ,CAAC;QAE9D,OAAO,EAAE,YAAY,EAAE;AACzB,IAAA,CAAC;AACH;;;;"}