{"version":3,"file":"sendViaSender.js","sources":["../../../../src/transactions/sendViaSender.ts"],"sourcesContent":["import { Signature, signature } from \"@solana/kit\";\nimport { SenderRegion, senderFastUrl } from \"./types\";\n\n/**\n * POST a base‑64 transaction to the chosen Sender region.\n * Sender mandates skipPreflight = true and maxRetries = 0\n *\n * Returns the transaction signature\n */\nexport const sendViaSender = async (\n  tx64: string,\n  region: SenderRegion = \"Default\",\n  swqosOnly: boolean = false\n): Promise<Signature> => {\n  const endpoint = swqosOnly\n    ? `${senderFastUrl(region)}?swqos_only=true`\n    : senderFastUrl(region);\n\n  const res = await fetch(endpoint, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({\n      jsonrpc: \"2.0\",\n      id: Date.now().toString(),\n      method: \"sendTransaction\",\n      params: [\n        tx64,\n        { encoding: \"base64\", skipPreflight: true, maxRetries: 0 },\n      ],\n    }),\n  });\n\n  /** Handle HTTP‑level failures early */\n  if (!res.ok) {\n    const text = await res.text();\n    throw new Error(`Sender HTTP ${res.status}: ${text.slice(0, 200)}`);\n  }\n\n  const body: unknown = await res.json();\n\n  if (typeof body === \"string\") return signature(body);\n\n  if (body && typeof body === \"object\") {\n    if (\"error\" in body && (body as any).error)\n      throw new Error(JSON.stringify((body as any).error));\n\n    if (\"result\" in body && typeof (body as any).result === \"string\")\n      return signature((body as any).result);\n  }\n\n  throw new Error(\n    `Unexpected Sender response: ${JSON.stringify(body).slice(0, 200)}`\n  );\n};\n"],"names":[],"mappings":";;;AAGA;;;;;AAKG;AACI,MAAM,aAAa,GAAG,OAC3B,IAAY,EACZ,MAAA,GAAuB,SAAS,EAChC,SAAA,GAAqB,KAAK,KACJ;IACtB,MAAM,QAAQ,GAAG;AACf,UAAE,CAAA,EAAG,aAAa,CAAC,MAAM,CAAC,CAAA,gBAAA;AAC1B,UAAE,aAAa,CAAC,MAAM,CAAC;AAEzB,IAAA,MAAM,GAAG,GAAG,MAAM,KAAK,CAAC,QAAQ,EAAE;AAChC,QAAA,MAAM,EAAE,MAAM;AACd,QAAA,OAAO,EAAE,EAAE,cAAc,EAAE,kBAAkB,EAAE;AAC/C,QAAA,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC;AACnB,YAAA,OAAO,EAAE,KAAK;AACd,YAAA,EAAE,EAAE,IAAI,CAAC,GAAG,EAAE,CAAC,QAAQ,EAAE;AACzB,YAAA,MAAM,EAAE,iBAAiB;AACzB,YAAA,MAAM,EAAE;gBACN,IAAI;gBACJ,EAAE,QAAQ,EAAE,QAAQ,EAAE,aAAa,EAAE,IAAI,EAAE,UAAU,EAAE,CAAC,EAAE;AAC3D,aAAA;SACF,CAAC;AACH,KAAA,CAAC;;AAGF,IAAA,IAAI,CAAC,GAAG,CAAC,EAAE,EAAE;AACX,QAAA,MAAM,IAAI,GAAG,MAAM,GAAG,CAAC,IAAI,EAAE;AAC7B,QAAA,MAAM,IAAI,KAAK,CAAC,eAAe,GAAG,CAAC,MAAM,CAAA,EAAA,EAAK,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,GAAG,CAAC,CAAA,CAAE,CAAC;IACrE;AAEA,IAAA,MAAM,IAAI,GAAY,MAAM,GAAG,CAAC,IAAI,EAAE;IAEtC,IAAI,OAAO,IAAI,KAAK,QAAQ;AAAE,QAAA,OAAO,SAAS,CAAC,IAAI,CAAC;AAEpD,IAAA,IAAI,IAAI,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;AACpC,QAAA,IAAI,OAAO,IAAI,IAAI,IAAK,IAAY,CAAC,KAAK;AACxC,YAAA,MAAM,IAAI,KAAK,CAAC,IAAI,CAAC,SAAS,CAAE,IAAY,CAAC,KAAK,CAAC,CAAC;QAEtD,IAAI,QAAQ,IAAI,IAAI,IAAI,OAAQ,IAAY,CAAC,MAAM,KAAK,QAAQ;AAC9D,YAAA,OAAO,SAAS,CAAE,IAAY,CAAC,MAAM,CAAC;IAC1C;AAEA,IAAA,MAAM,IAAI,KAAK,CACb,+BAA+B,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,GAAG,CAAC,CAAA,CAAE,CACpE;AACH;;;;"}