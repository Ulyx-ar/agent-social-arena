{"version":3,"file":"types.js","sources":["../../../../src/transactions/types.ts"],"sourcesContent":["import {\n  TransactionVersion,\n  Address,\n  TransactionSigner,\n  Instruction,\n  Blockhash,\n  Commitment,\n  BaseTransactionMessage,\n  TransactionMessageWithFeePayer,\n  Rpc,\n  SolanaRpcApi,\n  signTransactionMessageWithSigners,\n  RpcSubscriptions,\n  SolanaRpcSubscriptionsApi,\n  Signature,\n  Base64EncodedWireTransaction,\n} from \"@solana/kit\";\n\nimport { GetPriorityFeeEstimateFn } from \"../rpc/methods/getPriorityFeeEstimate\";\nimport { GetComputeUnitsFn } from \"./getComputeUnits\";\n\nexport interface GetComputeUnitsOpts {\n  // The floor for very small transactions. We default to 1k\n  min?: number;\n  // The buffer applied on top of simulated CU. We default to 10%\n  bufferPct?: number;\n}\n\nexport type SignedTx = Awaited<\n  ReturnType<typeof signTransactionMessageWithSigners>\n>;\n\nexport type BlockhashLifetime = Readonly<{\n  blockhash: Blockhash;\n  lastValidBlockHeight: bigint;\n}>;\n\nexport type CreateTxMessageInput = Readonly<{\n  version: TransactionVersion;\n  feePayer: Address | TransactionSigner<string>;\n  lifetime?: BlockhashLifetime;\n  instructions: readonly Instruction<string, readonly any[]>[];\n}>;\n\nexport type CreateSmartTxInput = Readonly<{\n  /** All required signers. First signer is the default fee‑payer. */\n  signers: readonly TransactionSigner<string>[];\n  /** Program instructions (no compute‑budget ixs needed — we’ll add them). */\n  instructions: readonly Instruction<string, readonly any[]>[];\n  /** Optional fee‑payer override (Address or TransactionSigner). */\n  feePayer?: Address | TransactionSigner<string>;\n  /** Tx version. Default: 0. */\n  version?: TransactionVersion;\n  /** Optional cap (µ‑lamports per CU) applied to Helius’ recommendation. */\n  priorityFeeCap?: number;\n  /** CU floor & simulation buffer. Defaults: 1_000 / 10%. */\n  minUnits?: number;\n  bufferPct?: number;\n  /** Commitment for fetching the blockhash. Default: \"confirmed\". */\n  commitment?: Commitment;\n}>;\n\nexport type CreateSmartTxResult = Readonly<{\n  /** Final signed transaction (ready to send). */\n  signed: SignedTx;\n  /** Base‑64 wire transaction of the final signed tx. */\n  base64: string;\n  /** Final compute‑unit limit set by the SDK. */\n  units: number;\n  /** Final microLamports‑per‑CU set by the SDK. */\n  priorityFee: number;\n  /** Final blockhash + lastValidBlockHeight used for the message. */\n  lifetime: BlockhashLifetime;\n  /** Final message (after compute‑budget ixs are prepended). */\n  message: BaseTransactionMessage & TransactionMessageWithFeePayer;\n}>;\n\nexport type CreateSmartTxDeps = Readonly<{\n  raw: Rpc<SolanaRpcApi>;\n  getComputeUnits: GetComputeUnitsFn;\n  getPriorityFeeEstimate: GetPriorityFeeEstimateFn;\n}>;\n\nexport type CreateSmartTransactionFn = (\n  args: CreateSmartTxInput\n) => Promise<CreateSmartTxResult>;\n\nexport type SendSmartTransactionInput = CreateSmartTxInput & {\n  /** Confirmation commitment for the send+confirm step. Default: \"confirmed\". */\n  confirmCommitment?: Commitment; // \"processed\" | \"confirmed\" | \"finalized\"\n  /** Forwarded to sendAndConfirm; default 0n. */\n  maxRetries?: bigint;\n  /** Forwarded to sendAndConfirm; default true. */\n  skipPreflight?: boolean;\n};\n\nexport type SendSmartTransactionFn = (\n  args: SendSmartTransactionInput\n) => Promise<string>;\n\nexport type SendSmartTxDeps = Readonly<{\n  raw: Rpc<SolanaRpcApi>;\n  /** Optional but recommended — enables WS-backed confirmation */\n  rpcSubscriptions?: RpcSubscriptions<SolanaRpcSubscriptionsApi>;\n  /** We compose on top of the creator to reuse your smart build/sign logic */\n  createSmartTransaction: CreateSmartTransactionFn;\n}>;\n\nexport interface BroadcastOptions {\n  lastValidBlockHeightOffset?: number;\n  // Overall polling timeout (ms). Defaults to 60_000 ms\n  pollTimeoutMs?: number;\n  // polling cadence (ms). Defaults to 2_000 ms\n  pollIntervalMs?: number;\n  // Defaults to true\n  skipPreflight?: boolean;\n  maxRetries?: bigint;\n  // pls don't use processed\n  commitment?: \"processed\" | \"confirmed\" | \"finalized\";\n}\n\nexport interface PollTxOptions {\n  // pls don't use processed\n  confirmationStatuses?: (\"processed\" | \"confirmed\" | \"finalized\")[];\n  timeout?: number;\n  interval?: number;\n  lastValidBlockHeight?: bigint | number;\n}\n\nexport type PollTransactionConfirmationFn = (\n  signature: Signature,\n  options?: PollTxOptions\n) => Promise<Signature>;\n\nexport type BroadcastTransactionFn = (\n  wireTx64: string | Base64EncodedWireTransaction,\n  options?: BroadcastOptions\n) => Promise<string>;\n\nexport const SENDER_ENDPOINTS = {\n  Default: \"https://sender.helius-rpc.com\",\n  US_SLC: \"http://slc-sender.helius-rpc.com\",\n  US_EAST: \"http://ewr-sender.helius-rpc.com\",\n  EU_WEST: \"http://lon-sender.helius-rpc.com\",\n  EU_CENTRAL: \"http://fra-sender.helius-rpc.com\",\n  EU_NORTH: \"http://ams-sender.helius-rpc.com\",\n  AP_SINGAPORE: \"http://sg-sender.helius-rpc.com\",\n  AP_TOKYO: \"http://tyo-sender.helius-rpc.com\",\n} as const;\n\nexport type SenderRegion = keyof typeof SENDER_ENDPOINTS;\n\n// `/fast` endpoint used for sending transactions\nexport const senderFastUrl = (region: SenderRegion) =>\n  `${SENDER_ENDPOINTS[region]}/fast`;\n\n// `/ping` endpoint used for connection warming\nexport const senderPingUrl = (region: SenderRegion) =>\n  `${SENDER_ENDPOINTS[region]}/ping`;\n\nexport interface CreateSmartTxWithTipInput extends CreateSmartTxInput {\n  // Defaults to 1_000\n  tipAmount?: number;\n}\n\nexport type CreateSmartTransactionWithTipFn = (\n  args: CreateSmartTxWithTipInput\n) => Promise<CreateSmartTxResult>;\n\nexport interface SendViaSenderOptions {\n  region: SenderRegion;\n  // Route only through SWQOS infra\n  swqosOnly?: boolean;\n  pollTimeoutMs?: number;\n  pollIntervalMs?: number;\n  // Explicit lamport tip override\n  tipAmount?: number;\n}\n\nexport type SendTransactionWithSenderFn = (\n  args: Omit<CreateSmartTxWithTipInput, \"tipAmount\"> & SendViaSenderOptions\n) => Promise<string>;\n\nexport interface SendSmartTxSenderDeps {\n  raw: Rpc<SolanaRpcApi>;\n  createSmartTransactionWithTip: (\n    i: CreateSmartTxWithTipInput\n  ) => Promise<CreateSmartTxResult>;\n}\n\nexport const SENDER_TIP_ACCOUNTS: Address[] = [\n  \"4ACfpUFoaSD9bfPdeu6DBt89gB6ENTeHBXCAi87NhDEE\" as Address,\n  \"D2L6yPZ2FmmmTKPgzaMKdhu6EWZcTpLy1Vhx8uvZe7NZ\" as Address,\n  \"9bnz4RShgq1hAnLnZbP8kbgBg1kEmcJBYQq3gQbmnSta\" as Address,\n  \"5VY91ws6B2hMmBFRsXkoAAdsPHBJwRfBht4DXox3xkwn\" as Address,\n  \"2nyhqdwKcJZR2vcqCyrYsaPVdAnFoJjiksCXJ7hfEYgD\" as Address,\n  \"2q5pghRs6arqVjRvT5gfgWfWcHWmw1ZuCzphgd5KfWGJ\" as Address,\n  \"wyvPkWjVZz1M8fHQnMMCDTQDbkManefNNhweYk5WkcF\" as Address,\n  \"3KCKozbAaF75qEU33jtzozcJ29yJuaLJTy2jFdzUY8bT\" as Address,\n  \"4vieeGHPYPG2MmyPRcYjdiDmmhN3ww7hsFNap8pVN3Ey\" as Address,\n  \"4TQLFNWK8AovT1gFvda5jfw2oJeRMKEmw7aH6MGBJ3or\" as Address,\n] as const;\n\nexport const MIN_TIP_LAMPORTS_DUAL = 1_000_000n; // 0.001 SOL\nexport const MIN_TIP_LAMPORTS_SWQOS = 500_000n; // 0.0005 SOL\n\nexport interface HeliusSendOptions {\n  skipPreflight?: boolean;\n  maxRetries?: number;\n  minContextSlot?: number;\n  preflightCommitment?: string;\n  validatorAcls?: string[];\n}\n\nexport type SendableTransaction =\n  | Base64EncodedWireTransaction\n  | { serialize(): Uint8Array }\n  | { base64: string }\n  | { signed: unknown };\n\nexport type SendTransactionFn = (\n  tx: SendableTransaction,\n  opts?: HeliusSendOptions\n) => Promise<Signature>;\n\nexport const SFDP_REJECTS_URL =\n  \"https://helius-docs.s3.us-east-2.amazonaws.com/sfdp_rejects.json\";\n"],"names":[],"mappings":"AA2IO,MAAM,gBAAgB,GAAG;AAC9B,IAAA,OAAO,EAAE,+BAA+B;AACxC,IAAA,MAAM,EAAE,kCAAkC;AAC1C,IAAA,OAAO,EAAE,kCAAkC;AAC3C,IAAA,OAAO,EAAE,kCAAkC;AAC3C,IAAA,UAAU,EAAE,kCAAkC;AAC9C,IAAA,QAAQ,EAAE,kCAAkC;AAC5C,IAAA,YAAY,EAAE,iCAAiC;AAC/C,IAAA,QAAQ,EAAE,kCAAkC;;AAK9C;AACO,MAAM,aAAa,GAAG,CAAC,MAAoB,KAChD,GAAG,gBAAgB,CAAC,MAAM,CAAC;AAE7B;AACO,MAAM,aAAa,GAAG,CAAC,MAAoB,KAChD,GAAG,gBAAgB,CAAC,MAAM,CAAC;AAgCtB,MAAM,mBAAmB,GAAc;IAC5C,8CAAyD;IACzD,8CAAyD;IACzD,8CAAyD;IACzD,8CAAyD;IACzD,8CAAyD;IACzD,8CAAyD;IACzD,6CAAwD;IACxD,8CAAyD;IACzD,8CAAyD;IACzD,8CAAyD;;AAGpD,MAAM,qBAAqB,GAAG,SAAW;AACzC,MAAM,sBAAsB,GAAG,QAAS;AAqBxC,MAAM,gBAAgB,GAC3B;;;;"}